#factor step
proof.arithmetic(False)
n=1084688440161525456565761297723021343753253859795834242323030221791996428064155741632924019882056914573754134213933081812831553364457966850480783858044755351020146309359045120079375683828540222710035876926280456195986410270835982861232693029200103036191096111928833090012465092747472907628385292492824489792241681880212163064150211815610372913101079146216940331740232522884290993565482822803814551730856710106385508489039042473394392081462669609250933566332939789
(u,v)=(1079311510414830031139310538989364057627185699077021276018232243092942690870213059161389825534830969580365943449482350229248945906866520819967957236255440270989833744079711900768144840591483525815244585394421988274792758875782239418100536145352175259508289748680619234207733291893262219468921233103016818320457126934347062355978211746913204921678806713434052571635091703300179193823668800062505275903102987517403501907477305095029634601150501028521316347448735695, 950119069222078086234887613499964523979451201727533569872219684563725731563439980545934017421736344519710579407356386725248959120187745206708940002584577645674737496282710258024067317510208074379116954056479277393224317887065763453906737739693144134777069382325155341867799398498938089764441925428778931400322389280512595265528512337796182736811112959040864126090875929813217718688941914085732678521954674134000433727451972397192521253852342394169735042490836886)
z=u^3-v^2
X=int(n^0.34)
#y^2=x^3+q (mod p)
P.<x> = PolynomialRing(ZZ)
f=x^2+z*x
polylist=[P(n^2),n^2*x,n*f,n*f*x,f^2]
M=Matrix(ZZ,5,5)
for i in range (0,5):
    for j in range (0,i+1):
        M[i,j]=polylist[i].list()[j]*X^j
N=M.LLL()
N=N[0]
newpoly=P(0)
for i in range (0,5):
    newpoly+=N[i]//(X^i)*x^i
q=newpoly.roots()[0][0]
q=Integer(q)
p=Integer(n//q)
e = 65537 
#CRT step
E = EllipticCurve(Zmod(p), [p, q])
ordp=E.order()
dp=pow(e,-1,Integer(ordp))
G=E(u,v)
Gp=G*dp
E = EllipticCurve(Zmod(q), [p, q])
ordq=E.order()
dq=pow(e,-1,Integer(ordq))
G=E(u,v)
Gq=G*dq

u0=crt([Integer(Gp[0]),Integer(Gq[0])],[p,q])
v0=crt([Integer(Gp[1]),Integer(Gq[1])],[p,q])
u0=Integer(u0)
print(bytes.fromhex(u0.hex()))
